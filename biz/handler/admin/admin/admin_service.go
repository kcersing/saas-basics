// Code generated by hertz generator.

package admin

import (
	"context"
	"github.com/cloudwego/hertz/pkg/app"
	"github.com/cloudwego/hertz/pkg/protocol/consts"
	"saas/idl_gen/model/base"
	"saas/infras/service/admin"
	"saas/pkg/errno"
	"saas/pkg/utils"
)

// HealthCheck .
// @router /api/health [GET]
func HealthCheck(ctx context.Context, c *app.RequestContext) {
	var err error
	var req base.Empty
	err = c.BindAndValidate(&req)
	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), nil, 0, "")
		return
	}

	resp := new(base.NilResponse)

	c.JSON(consts.StatusOK, resp)
}

// Captcha .
// @router /api/captcha [POST]
func Captcha(ctx context.Context, c *app.RequestContext) {
	var err error
	var req base.Empty
	err = c.BindAndValidate(&req)
	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), nil, 0, "")
		return
	}

	id, b64s, _, err := admin.NewCaptcha(ctx, c).GetCaptcha()

	utils.SendResponse(c, errno.Success, map[string]string{
		"captchaId": id,
		"imgPath":   b64s,
	}, 0, "")

}
