// Code generated by hertz generator.

package admin

import (
	"context"
	"saas/biz/infras/service"
	"saas/pkg/errno"
	"saas/pkg/utils"

	"github.com/cloudwego/hertz/pkg/app"
	"github.com/cloudwego/hertz/pkg/protocol/consts"
	base "saas/idl_gen/model/base"
)

// HealthCheck .
//
//	@router	/service/health [GET]
func HealthCheck(ctx context.Context, c *app.RequestContext) {
	var err error
	var req base.Empty
	err = c.BindAndValidate(&req)
	if err != nil {
		c.String(consts.StatusBadRequest, err.Error())
		return
	}

	resp := new(base.NilResponse)

	c.JSON(consts.StatusOK, resp)
}

// Captcha .
//
//	@Summary		获取验证码 Summary
//	@Description	获取验证码 Description
//	@Router			/service/captcha [POST]
func Captcha(ctx context.Context, c *app.RequestContext) {
	var err error
	var req base.Empty
	err = c.BindAndValidate(&req)
	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), nil, 0, "")
		return
	}

	id, b64s, _, err := service.NewCaptcha(ctx, c).GetCaptcha()

	utils.SendResponse(c, errno.Success, map[string]string{
		"captchaId": id,
		"imgPath":   b64s,
	}, 0, "")
}
